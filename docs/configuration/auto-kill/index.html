<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Auto Kill"><meta property="og:title" content><meta property="og:description" content="Automatically kill programs InGRAINd can execute various commands to react to certain events with minimum overhead.
Because events are not intercepted, merely observed by the eBPF probe, InGRAIN cannot block a program from executing a certain action.
However, using the events pipeline to filter and execute commands, InGRAIN can react to events quickly and reliably without involving other processing components. This means you fundamentally cannot stop a task from executing, but long-running processes can be killed."><meta property="og:type" content="article"><meta property="og:url" content="http://ingrain.redsift.io/docs/configuration/auto-kill/"><meta property="article:modified_time" content="2020-02-21T16:59:47+00:00"><title>Auto Kill | InGRAINd</title><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.edc993575be58655f3e49634e3ca6db09cc38ac9aa03ecdbe81d941636e35273.css integrity="sha256-7cmTV1vlhlXz5JY048ptsJzDismqA+zb6B2UFjbjUnM="><script defer src=/en.search.min.095efb27360ecd09957abf08f97b49b5fd8bc0bbc88a024d78f45ee65080e56c.js integrity="sha256-CV77JzYOzQmVer8I+XtJtf2LwLvIigJNePRe5lCA5Ww="></script></head><body><input type=checkbox class=hidden id=menu-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><span>InGRAINd</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><p><a href=/docs/getting-started/>Getting started</a></p></li><li><p><a href=/docs/configuration/syntax/>Configuration</a></p><ul><li><a href=/docs/configuration/containers/>Container monitoring</a></li><li><a href=/docs/configuration/network/>Network monitoring</a></li><li><a href=/docs/configuration/auto-kill/ class=active>Auto-kill programs</a></li><li><a href=/docs/configuration/backends/>Backends</a></li><li><a href=/docs/configuration/statsd/>StatsD server</a></li><li><a href=/docs/configuration/osquery/>OsQuery</a></li></ul></li><li><p><a href=/docs/deployment/strategies/>Deployment</a></p><ul><li><a href=/docs/deployment/kubernetes/>Kubernetes</a></li><li><a href=/docs/deployment/ansible/>Ansible/SystemD</a></li></ul></li><li><p><a href=/docs/grain/intro/>Extending InGRAINd</a></p><ul><li><a href=/docs/grain/cargo-bpf/>cargo bpf</a></li><li><a href=/docs/grain/ebpf/>Writing an eBPF module</a></li><li><a href=/docs/grain/userspace/>Userspace events</a></li><li>Advanced<ul><li><a href=/docs/devel/profiling/>Profiling</a></li><li><a href=/docs/devel/performance/>Performance</a></li><li><a href=/docs/devel/internals/>Internals</a></li></ul></li></ul></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Auto Kill</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><input type=checkbox class=hidden id=toc-control><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#monitoring-a-directory>Monitoring a directory</a></li></ul></nav></aside></header><article class=markdown><h1 id=automatically-kill-programs>Automatically kill programs</h1><p>InGRAINd can execute various commands to react to certain events with minimum overhead.</p><p>Because events are not <em>intercepted</em>, merely <em>observed</em> by the eBPF
probe, InGRAIN cannot block a program from executing a certain
action.</p><p>However, using the events pipeline to filter and execute commands,
InGRAIN can react to events quickly and reliably without involving
other processing components. This means you fundamentally cannot stop
a task from executing, but long-running processes can be killed.</p><p>You can configure this behaviour by adding the <code>Exec</code> step to your
<code>pipeline</code>:</p><pre><code>[[pipeline.s3.steps]]
type = &quot;Exec&quot;
arguments = [&quot;kill&quot;, &quot;-9&quot;, &quot;{ process_id }&quot;]
only_if = [
    { key = &quot;some_key&quot;, regex = &quot;prefix.*&quot; }
]
</code></pre><h2 id=monitoring-a-directory>Monitoring a directory</h2><p>For example, to stop someone editing your SSH keys using
Vim, you can use the following configuration:</p><pre><code>[[probe]]
pipelines = [&quot;console&quot;]
[probe.config]
type = &quot;files&quot;
monitor_dirs = [&quot;/home/user&quot;]

[[pipeline.s3.steps]]
type = &quot;Exec&quot;
command = [&quot;kill&quot;, &quot;-9&quot;, &quot;{ process_id }&quot;]
only_if = [
    { key = &quot;process_str&quot;, regex = &quot;.*vim&quot; },
    { key = &quot;path_str&quot;, regex = &quot;.*.ssh/id_.*&quot; },
]
</code></pre></article><footer class=book-footer><div class="flex justify-between"></div><div class=book-comments></div></footer></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#monitoring-a-directory>Monitoring a directory</a></li></ul></nav></aside></main></body></html>