<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Automatically kill programs InGRAINd can execute various commands to react to certain events with minimum overhead.
Because events are not intercepted, merely observed by the eBPF probe, InGRAIN cannot block a program from executing a certain action.
However, using the events pipeline to filter and execute commands, InGRAIN can react to events quickly and reliably without involving other processing components. This means you fundamentally cannot stop a task from executing, but long-running processes can be killed."><meta property="og:title" content><meta property="og:description" content="Automatically kill programs InGRAINd can execute various commands to react to certain events with minimum overhead.
Because events are not intercepted, merely observed by the eBPF probe, InGRAIN cannot block a program from executing a certain action.
However, using the events pipeline to filter and execute commands, InGRAIN can react to events quickly and reliably without involving other processing components. This means you fundamentally cannot stop a task from executing, but long-running processes can be killed."><meta property="og:type" content="article"><meta property="og:url" content="http://ingrain.redsift.io/docs/configuration/auto-kill/"><meta property="article:modified_time" content="2020-02-21T16:59:47+00:00"><title>Auto Kill | InGRAINd</title><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/scss/main.min.d919f2a251348a936b3702a98cee295688249ebba33850dc8dfe10fbecea7d03.css integrity="sha256-2RnyolE0ipNrNwKpjO4pVogknrujOFDcjf4Q++zqfQM="><script defer src=/en.menu-toggle.min.065112191a6cf152ee534a28affbce063cfaf63f08797bd3389675c2310a2318.js integrity="sha256-BlESGRps8VLuU0oor/vOBjz69j8IeXvTOJZ1wjEKIxg="></script><script defer src=/en.search.min.0025bb22a7dc93d84181bfdd6b3edbef5b17f21e03af98ade1abd4cfa8e58cb6.js integrity="sha256-ACW7Iqfck9hBgb/daz7b71sX8h4Dr5it4avUz6jljLY="></script><script async defer src=https://buttons.github.io/buttons.js></script><link href="https://fonts.googleapis.com/css?family=Raleway:400,500,600,700,900%7cSource+Code+Pro:400,500&display=swap" rel=stylesheet></head><body class=fixed-position><div id=wrapper><a class=accessibility href=#main>Skip to Content</a><header id=header><div class=container><strong class=logo><a href=#><img src=/svg/logo.svg alt=Ingraind width=135></a></strong>
<a class=nav-opener href=#>nav-opener<span></span></a><div class=drop><nav class="nav main-menu"><ul><li><a href=/>Intro</a></li><li><a href=/docs/configuration/syntax/>Documentation</a></li><li><a href=/api/redbpf/>API</a></li><li><a href=https://blog.redsift.com/category/labs/>Blog</a></li></ul></nav><ul class=social-networks><li><a href=https://github.com/redsift/ingraind><i class=icon-github></i>github</a></li><li><a href=https://twitter.com/redsift><i class=icon-twitter></i>twitter</a></li></ul></div></div></header><input type=checkbox class=hidden id=toc-control><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#monitoring-a-directory>Monitoring a directory</a></li></ul></nav></aside><main id=main><div class="container inner-container"><aside class=sidebar><div class=fixed-block><nav class="nav-holder hide"><strong class="logo hide"><a href=/><img src=/svg/logo.svg alt=ingraind width=135></a>
<span>v1.0</span></strong><form action=# class=form-search><label class=hidden for=search>Search</label>
<input id=book-search-input type=search placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner spinner hidden"></div><ul id=book-search-results class=nav-list></ul></form><ul><li><p><a href=/docs/getting-started/>Getting started</a></p></li><li><p><a href=/docs/configuration/syntax/>Configuration</a></p><ul><li><a href=/docs/configuration/containers/>Container monitoring</a></li><li><a href=/docs/configuration/network/>Network monitoring</a></li><li><a href=/docs/configuration/auto-kill/ class=active>Auto-kill programs</a></li><li><a href=/docs/configuration/backends/>Backends</a></li><li><a href=/docs/configuration/statsd/>StatsD server</a></li><li><a href=/docs/configuration/osquery/>OsQuery</a></li></ul></li><li><p><a href=/docs/deployment/strategies/>Deployment</a></p><ul><li><a href=/docs/deployment/kubernetes/>Kubernetes</a></li><li><a href=/docs/deployment/ansible/>Ansible/SystemD</a></li></ul></li><li><p><a href=/docs/grain/intro/>Extending InGRAINd</a></p><ul><li><a href=/docs/grain/cargo-bpf/>cargo bpf</a></li><li><a href=/docs/grain/ebpf/>Writing an eBPF module</a></li><li><a href=/docs/grain/userspace/>Userspace events</a></li><li>Advanced<ul><li><a href=/docs/devel/profiling/>Profiling</a></li><li><a href=/docs/devel/performance/>Performance</a></li><li><a href=/docs/devel/internals/>Internals</a></li></ul></li></ul></li></ul></nav><script>(function(){var menu=document.querySelector("aside.sidebar nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></div></aside><div class=content><article class=markdown><h1 id=automatically-kill-programs>Automatically kill programs</h1><p>InGRAINd can execute various commands to react to certain events with minimum overhead.</p><p>Because events are not <em>intercepted</em>, merely <em>observed</em> by the eBPF
probe, InGRAIN cannot block a program from executing a certain
action.</p><p>However, using the events pipeline to filter and execute commands,
InGRAIN can react to events quickly and reliably without involving
other processing components. This means you fundamentally cannot stop
a task from executing, but long-running processes can be killed.</p><p>You can configure this behaviour by adding the <code>Exec</code> step to your
<code>pipeline</code>:</p><pre><code>[[pipeline.s3.steps]]
type = &quot;Exec&quot;
arguments = [&quot;kill&quot;, &quot;-9&quot;, &quot;{ process_id }&quot;]
only_if = [
    { key = &quot;some_key&quot;, regex = &quot;prefix.*&quot; }
]
</code></pre><h2 id=monitoring-a-directory>Monitoring a directory</h2><p>For example, to stop someone editing your SSH keys using
Vim, you can use the following configuration:</p><pre><code>[[probe]]
pipelines = [&quot;console&quot;]
[probe.config]
type = &quot;files&quot;
monitor_dirs = [&quot;/home/user&quot;]

[[pipeline.s3.steps]]
type = &quot;Exec&quot;
command = [&quot;kill&quot;, &quot;-9&quot;, &quot;{ process_id }&quot;]
only_if = [
    { key = &quot;process_str&quot;, regex = &quot;.*vim&quot; },
    { key = &quot;path_str&quot;, regex = &quot;.*.ssh/id_.*&quot; },
]
</code></pre></article></div><aside class="aside hide"><div class=fixed-block><h3>Contents</h3><nav id=TableOfContents><ul><li><a href=#monitoring-a-directory>Monitoring a directory</a></li></ul></nav></div></aside></div></main><footer id=footer><div class=container><span class=copy>&copy; 2020 <a href=#>Red Sift</a>. All rights reserved.</span><div class=social-block><ul class=social-networks><li><a href=https://github.com/redsift/ingraind><i class=icon-github></i>github</a></li><li><a href=https://twitter.com/redsift><i class=icon-twitter></i>twitter</a></li></ul></div></div></footer><a class=accessibility href=#wrapper>Back to top</a></div></body></html>